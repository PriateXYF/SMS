import base64
from module.api import Script
from typing import Annotated

class MorseDecode(Script):
    """对给定字符串进行莫斯解码"""

    def run(self, text: Annotated[str, "需要解码的文本"]):
        morse_dict = {
            ".-": "A",
            "-...": "B",
            "-.-.": "C",
            "-..": "D",
            ".": "E",
            "..-.": "F",
            "--.": "G",
            "....": "H",
            "..": "I",
            ".---": "J",
            "-.-": "K",
            ".-..": "L",
            "--": "M",
            "-.": "N",
            "---": "O",
            ".--.": "P",
            "--.-": "Q",
            ".-.": "R",
            "...": "S",
            "-": "T",
            "..-": "U",
            "...-": "V",
            ".--": "W",
            "-..-": "X",
            "-.--": "Y",
            "--..": "Z",
            "-----": "0",
            ".----": "1",
            "..---": "2",
            "...--": "3",
            "....-": "4",
            ".....": "5",
            "-....": "6",
            "--...": "7",
            "---..": "8",
            "----.": "9",
            ".-.-.-": ".",
            "--..--": ",",
            "..--..": "?",
            ".----.": "'",
            "-.-.--": "!",
            "-..-.": "/",
            "-.--.": "(",
            "-.--.-": ")",
            ".-...": "&",
            "---...": ":",
            "-.-.-.": ";",
            "-...-": "=",
            ".-.-.": "+",
            "-....-": "-",
            "..--.-": "_",
            ".-..-.": '"',
            "...-..-": "$",
            ".--.-.": "@",
            "...---...": "SOS",
        }
        # 按空格分割传入的电码字符串
        words = text.split("/")  # 单词之间用 / 表示空格
        decoded_message = []

        for word in words:
            # 分割单词中的每个字符
            letters = word.split()
            decoded_word = "".join(morse_dict.get(letter, "") for letter in letters)
            decoded_message.append(decoded_word)

        return " ".join(decoded_message)
